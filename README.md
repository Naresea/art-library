# Art Library

A webapp intended to organize images and art for VTT applications.

## Disclaimer
The software is still in very early development,
so *do not run it on the public internet* without extra protection (e.g. an Nginx reverser proxy hiding it behind proper authentication).
Also, please don't upload any super-important / confidential / private material.

## Credits
All the beautiful token thumbnails you see in the screenshots below are made by Jan Loos on Patreon.
If you like his art, you can find him here: https://www.patreon.com/onlinetabletop/posts

## What is it?
During the COVID-19 pandemic I started collecting heaps and heaps of artwork, tokens and battlemaps
for online playing P&P games like Dungeons & Dragons 5, Pathfinder 2, Splittermond and Shadowrun with my friends.
I follow several artists on Patreon and with hundreds of images I needed a way to organize the,

I wanted some software that I could host alongside my own Foundry VTT server, that offered me a quick search
function similar to Google's image search and that I could use from both my smartphone and my desktop computer.
There are several solutions available for that already of course, but I decided to try implementing one on my own,
as a hobby project.

The software as it is now is far from finished, but it is usable already.
It uses Spring Boot as a Java server, Angular in the frontend, PostgreSQL as database
and Lucene for searching files.

Further down the road I might even find time to integrate it directly into a Foundry VTT module...
but that's not yet decided.

## Features
- Uploaded images are automatically converted into webp format for VTT apps
- Thumbnails in 128x128, 256x256 and 512x512 are auto-generated during upload
- Tags are automatically generated by parsing the filename during upload
- Drag & Drop support for desktop (even for downloading full size images from the gallery, if you first press the mouse, wait for a second and then start dragging)
- Responsive layout for both desktop and mobile
- Search functionality powered by Apache Lucene (https://lucene.apache.org/), the same engine that runs AWS elastic search
- Query syntax can be found here: https://lucene.apache.org/core/2_9_4/queryparsersyntax.html

## Problems
- Uploads greater than 2GB will fail without message. That limit can be increased in the application.yml

## Screenshots

### Main Page
![image](screenshots/main-app.JPG)

### Search
![image](screenshots/search-dragon.JPG)

![image](screenshots/search-and.JPG)

### Image Details with Download and Edit buttons

![image](screenshots/lightroom.JPG)

### Edit Form

![image](screenshots/edit-details.JPG)

### Upload

![image](screenshots/upload-01.JPG)

![image](screenshots/upload-02.JPG)

![image](screenshots/upload-03.JPG)

### Mobile version
![image](screenshots/mobile-gallery.JPG)

![image](screenshots/mobile-lightroom.JPG)

![image](screenshots/mobile-details.JPG)

![image](screenshots/mobile-details-keyboard.JPG)

![image](screenshots/mobile-upload-list.JPG)


## How to run

### Dependencies:

- You have to install both Apache Maven and a JDK to compile and start the backend server
- You must have NodeJS version 14+ installed

### Setup
- Install the required node_modules: ````npm i````
- Choose one of these two options:
  - Download a valid JDK for your Operating System and extract it to ``external/jdk-16.0.1``. This JRE will be bundled with your Electron App
  - Edit ``electron/index.js`` and change the ``JAVA_CMD`` constant to just 'java' if you want to use your OS' java installation

#### Compile the software to an electron app
- Run ````npm run build````, this will compile the server, the frontend and tie everything together in an electron app

#### Compile the software for electron development
- Run ````npm run build-server```` to compile, followed by ````npm run start.electron```` to start the software as electron app in dev mode

#### Programming
- Run ````npm run start.dev````. This will compile and start the backend server in SQLite mode and compile, start and watch the frontend

#### Dedicated server
- Edit ``spring-server/src/main/resources/application-dedicated.yml`` to use the correct config for your PostgreSQL database
- Go into angular-frontend and compile the frontend (npm run build)
- Copy the frontend from ``angular/frontend/dist`` into ``spring-server/src/main/resources/public``
- Go into spring-server and compile the server with ``mvn clean package``
- Go into spring-server/target and start the server with ``java -jar art-library-backend-1.0-SNAPSHOT.jar --spring.profiles.active=dedicated``

## Planned Features
If I find the time...

- split all images selected for upload into "sizable" 100 MB chunks and upload them, to get a more reasonable size per upload
- make tags editable during upload
- fix everything listed under "problems"
- add a config page for categories and tags
- add a navigation item for each category and implicitly apply that category to each search
- automatically switch to the gallery when a search is started
- add a helper to build complex queries
- add a special config option to explicitly sync the search index back with the database
- include a dictionary when trying to auto-parse tags during upload (currently it's a regex that splits at whitespace, underscore, dash, etc.)
- maybe include options for audio files as well... preview would be an audio player then, I guess
- if I ever get here, built a module for Foundry VTT to integrate the Lucene search, gallery and upload directly into Foundry
